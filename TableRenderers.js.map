{"version":3,"sources":["src/TableRenderers.jsx"],"names":["spanSize","arr","i","j","x","asc","end","noDraw","len","length","asc1","end1","stop","TableRenderer","props","state","headersRows","stubEntry","stubId","headerEntry","headerAttr","userResponses","settings","showPercentage","headerOptionId","id","forEach","entry","baseScore","stubScore","stubScores","response","value","cells","map","score","Math","round","headerData","headerKeys","missingValues","flatMap","find","record","missingRaw","missingValue","headerId","total","index","finalRowLength","sums","rows","selectedValues","ceil","row","optionsLength","push","title","questionId","base","stub","checkedValues","filter","selectedValue","Array","_","html","divider","React","cloneElement","th","colSpan","setState","headers","data","it","currHeaderKey","headerRecord","headerQuestionId","headerOptions","option","text","nextOptionCells","nextHeaderKey","nextHeaderRecord","nextHeaderQuestionId","nextHeaderOptions","nextOption","o","updateSpans","prevProps","prevState","refreshHeaders","JSON","stringify","pivotData","PivotData","stubFilters","stubValueFilter","headerFilters","headerValueFilter","multiLevelMode","multiFlatMode","dCopy","Object","assign","dB","key","keys","options","values","filterProp","filterValues","stubData","stubKeys","stubs","headerLastRowIndex","headersSpanSize","currKey","headerKey","headerEntries","headerFullEntry","headerOption","getHeaderBase","element","getMultiLevelHeaderBase","stubKey","stubOption","showStubLabel","objs","qLabelRowSpan","calculateCell","calculateMultiLevelCell","calculateMissingValues","calculateMultiLevelMissingValue","Component"],"mappings":"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","file":"TableRenderers.js","sourcesContent":["import React from 'react';\nimport {PivotData} from './Utilities';\n\n/* eslint-disable react/prop-types */\n\nconst spanSize = function(arr, i, j) {\n  let x;\n  if (i !== 0) {\n    let asc, end;\n    let noDraw = true;\n    for (\n      x = 0, end = j, asc = end >= 0;\n      asc ? x <= end : x >= end;\n      asc ? x++ : x--\n    ) {\n      if (arr[i - 1][x] !== arr[i][x]) {\n        noDraw = false;\n      }\n    }\n    if (noDraw) {\n      return -1;\n    }\n  }\n  let len = 0;\n  while (i + len < arr.length) {\n    let asc1, end1;\n    let stop = false;\n    for (\n      x = 0, end1 = j, asc1 = end1 >= 0;\n      asc1 ? x <= end1 : x >= end1;\n      asc1 ? x++ : x--\n    ) {\n      if (arr[i][x] !== arr[i + len][x]) {\n        stop = true;\n      }\n    }\n    if (stop) {\n      break;\n    }\n    len++;\n  }\n  return len;\n};\n\nclass TableRenderer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      headersRows: [],\n    };\n  }\n\n  calculateCell(stubEntry, stubId, headerEntry, headerAttr) {\n    const {userResponses, settings} = this.props;\n    const {showPercentage} = settings;\n\n    const headerOptionId = headerEntry.id;\n\n    headerEntry[headerAttr].forEach(entry => {\n      entry.baseScore = 0;\n      entry.stubScore = 0;\n\n      if (!entry.stubScores) {\n        entry.stubScores = {};\n      }\n    });\n\n    userResponses.forEach(response => {\n      headerEntry[headerAttr].forEach(entry => {\n        if (!entry.stubScores[headerAttr]) {\n          entry.stubScores[headerAttr] = {};\n        }\n\n        if (response[headerOptionId] === entry.value) {\n          entry.baseScore++;\n\n          if (!entry.stubScores[headerAttr][stubId]) {\n            entry.stubScores[headerAttr][stubId] = 0;\n          }\n\n          if (response[stubId] === stubEntry.value) {\n            entry.stubScore++;\n            entry.stubScores[headerAttr][stubId] += 1;\n          }\n        }\n      });\n    });\n\n    const cells = headerEntry[headerAttr].map(entry => {\n      if (showPercentage) {\n        const score = Math.round((entry.stubScore / entry.baseScore) * 100);\n        return <td>{`${score ? score : 0}%`}</td>;\n      }\n\n      return <td>{entry.stubScore}</td>;\n    });\n\n    return cells;\n  }\n\n  calculateMissingValues(headerData, headerKeys, stubId) {\n    const {settings} = this.props;\n    const {showPercentage} = settings;\n\n    const missingValues = headerKeys.flatMap(headerAttr => {\n      const headerEntry = headerData.find(record =>\n        record[headerAttr] ? record : null\n      );\n\n      return headerEntry[headerAttr].map(entry => {\n        const missingRaw =\n          entry.baseScore - entry.stubScores[headerAttr][stubId];\n\n        if (showPercentage) {\n          const missingValue = Math.round((missingRaw / entry.baseScore) * 100);\n          return missingValue ? missingValue : 0;\n        }\n\n        return missingRaw;\n      });\n    });\n\n    return missingValues;\n  }\n\n  getHeaderBase(headerEntry, headerId) {\n    const {userResponses} = this.props;\n    let total = 0;\n\n    userResponses.forEach(response => {\n      if (response[headerId] === headerEntry.value) {\n        total++;\n      }\n    });\n\n    return total;\n  }\n\n  calculateMultiLevelCell(stubEntry, stubId, index, finalRowLength, sums) {\n    const {userResponses, settings} = this.props;\n    const {showPercentage} = settings;\n    const rows = [...this.state.headersRows];\n    const selectedValues = [];\n\n    rows.forEach(row => {\n      const value =\n        Math.ceil(((index + 1) * row.length) / finalRowLength) %\n        row.optionsLength;\n\n      selectedValues.push({\n        title: row.title,\n        questionId: row.questionId,\n        value: value > 0 ? value : row.optionsLength,\n      });\n    });\n\n    const entry = {\n      baseScore: 0,\n      stubScore: 0,\n      stubScores: {},\n    };\n\n    if (!sums[index]) {\n      sums[index] = {\n        base: 0,\n        stub: 0,\n      };\n    }\n\n    if (sums[index].base > 0) {\n      sums[index].base = 0;\n    }\n    userResponses.forEach(response => {\n      if (!entry.stubScores[index]) {\n        entry.stubScores[index] = {};\n      }\n\n      const checkedValues = selectedValues.filter(\n        selectedValue =>\n          response[selectedValue.questionId] == selectedValue.value\n      );\n\n      if (checkedValues.length === selectedValues.length) {\n        entry.baseScore++;\n        sums[index].base++;\n\n        if (!entry.stubScores[index][stubId]) {\n          entry.stubScores[index][stubId] = 0;\n        }\n\n        if (response[stubId] === stubEntry.value) {\n          if (sums[index].stub >= 0) {\n            sums[index].stub += 1;\n          }\n\n          entry.stubScore++;\n        }\n      }\n    });\n\n    if (showPercentage) {\n      const score = Math.round((entry.stubScore / entry.baseScore) * 100);\n      return <td>{`${score ? score : 0}%`}</td>;\n    }\n\n    return <td>{entry.stubScore}</td>;\n  }\n\n  calculateMultiLevelMissingValue(finalRowLength, sums) {\n    const {settings} = this.props;\n    const {showPercentage} = settings;\n\n    const missingValues = [...Array(finalRowLength)].flatMap((_, index) => {\n      if (sums[index]) {\n        const missingRaw = sums[index].base - sums[index].stub;\n\n        if (showPercentage) {\n          const missingValue = Math.round(\n            (missingRaw / sums[index].base) * 100\n          );\n          return missingValue ? missingValue : 0;\n        }\n\n        return missingRaw;\n      }\n    });\n\n    return missingValues ? missingValues : [];\n  }\n\n  getMultiLevelHeaderBase(index, finalRowLength) {\n    const {userResponses} = this.props;\n    const rows = [...this.state.headersRows];\n    const selectedValues = [];\n\n    let total = 0;\n\n    rows.forEach(row => {\n      const value =\n        Math.ceil(((index + 1) * row.length) / finalRowLength) %\n        row.optionsLength;\n\n      selectedValues.push({\n        title: row.title,\n        questionId: row.questionId,\n        value: value > 0 ? value : row.optionsLength,\n      });\n    });\n\n    userResponses.forEach(response => {\n      const checkedValues = selectedValues.filter(\n        selectedValue =>\n          response[selectedValue.questionId] == selectedValue.value\n      );\n\n      if (checkedValues.length === selectedValues.length) {\n        total++;\n      }\n    });\n\n    return total;\n  }\n\n  updateSpans() {\n    const rows = [...this.state.headersRows];\n\n    rows.forEach(row => {\n      row.html = row.html.map(th => {\n        const divider = rows.length > 1 ? rows[rows.length - 1].length : 1;\n\n        return React.cloneElement(th, {\n          colSpan: divider / row.length,\n        });\n      });\n    });\n\n    this.setState({\n      headersRows: rows,\n    });\n  }\n\n  refreshHeaders() {\n    const rows = [];\n    const headerKeys = this.props.headers;\n    const headerData = this.props.data;\n    let it = 0;\n\n    // insert top row\n    const currHeaderKey = headerKeys[it];\n    const headerRecord = headerData.find(record =>\n      record[currHeaderKey] ? record : null\n    );\n    const headerQuestionId = headerRecord.id;\n    const headerOptions = headerRecord[currHeaderKey];\n\n    rows.push({\n      html: headerOptions.map(option => <th>{option.text}</th>),\n      length: headerOptions.length,\n      optionsLength: headerOptions.length,\n      title: currHeaderKey,\n      questionId: headerQuestionId,\n    });\n\n    while (it < headerKeys.length - 1) {\n      const nextOptionCells = [];\n\n      const nextHeaderKey = headerKeys[it + 1];\n      const nextHeaderRecord = headerData.find(record =>\n        record[nextHeaderKey] ? record : null\n      );\n      const nextHeaderQuestionId = nextHeaderRecord.id;\n      const nextHeaderOptions = nextHeaderRecord[nextHeaderKey];\n\n      for (let j = 0; j < rows[it].length; j++) {\n        nextHeaderOptions.forEach(nextOption => {\n          nextOptionCells.push(<th colSpan=\"1\">{nextOption.text}</th>);\n        });\n      }\n\n      rows.push({\n        html: nextOptionCells.map(o => o),\n        length: nextOptionCells.length,\n        optionsLength: nextHeaderOptions.length,\n        title: nextHeaderKey,\n        questionId: nextHeaderQuestionId,\n      });\n\n      it++;\n    }\n\n    this.setState(\n      {\n        headersRows: rows,\n      },\n      () => {\n        this.updateSpans();\n      }\n    );\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.headers !== this.props.headers) {\n      let it = 0;\n\n      const rows = [...this.state.headersRows];\n      const headerKeys = this.props.headers;\n      const headerData = this.props.data;\n\n      if (this.props.headers.length <= prevProps.headers.length) {\n        this.refreshHeaders();\n        return;\n      }\n      if (headerKeys.length === 1) {\n        const currHeaderKey = headerKeys[it];\n        const headerRecord = headerData.find(record =>\n          record[currHeaderKey] ? record : null\n        );\n        const headerQuestionId = headerRecord.id;\n        const headerOptions = headerRecord[currHeaderKey];\n\n        rows.push({\n          html: headerOptions.map(option => <th>{option.text}</th>),\n          length: headerOptions.length,\n          optionsLength: headerOptions.length,\n          title: currHeaderKey,\n          questionId: headerQuestionId,\n        });\n      } else {\n        it = this.state.headersRows.length - 1;\n      }\n\n      while (it < headerKeys.length - 1) {\n        const nextOptionCells = [];\n\n        const nextHeaderKey = headerKeys[it + 1];\n        const nextHeaderRecord = headerData.find(record =>\n          record[nextHeaderKey] ? record : null\n        );\n        const nextHeaderQuestionId = nextHeaderRecord.id;\n        const nextHeaderOptions = nextHeaderRecord[nextHeaderKey];\n\n        for (let j = 0; j < this.state.headersRows[it].length; j++) {\n          nextHeaderOptions.forEach(nextOption => {\n            nextOptionCells.push(<th colSpan=\"1\">{nextOption.text}</th>);\n          });\n        }\n\n        rows.push({\n          html: nextOptionCells.map(o => o),\n          length: nextOptionCells.length,\n          optionsLength: nextHeaderOptions.length,\n          title: nextHeaderKey,\n          questionId: nextHeaderQuestionId,\n        });\n        it++;\n      }\n\n      this.setState({\n        headersRows: rows,\n      });\n    }\n\n    if (\n      JSON.stringify(prevState.headersRows) !==\n        JSON.stringify(this.state.headersRows) &&\n      this.props.headers.length > 1\n    ) {\n      this.updateSpans();\n    }\n  }\n\n  render() {\n    const pivotData = new PivotData(this.props);\n\n    const stubFilters = pivotData.props.stubValueFilter;\n    const headerFilters = pivotData.props.headerValueFilter;\n\n    const multiLevelMode = this.props.multiLevelMode;\n    const multiFlatMode = !multiLevelMode;\n\n    const headerData = pivotData.props.data.map(dB => {\n      const dCopy = Object.assign({}, dB);\n      const key = Object.keys(dCopy)[0];\n      const options = Object.values(dCopy)[0].filter(option => {\n        for (const filterProp in headerFilters) {\n          const filterValues = headerFilters[filterProp];\n          if (filterValues[option.text]) {\n            return false;\n          }\n        }\n        return true;\n      });\n\n      dCopy[key] = options;\n      return dCopy;\n    });\n\n    const stubData = pivotData.props.data.map(dB => {\n      const dCopy = Object.assign({}, dB);\n      const key = Object.keys(dCopy)[0];\n      const options = Object.values(dCopy)[0].filter(option => {\n        for (const filterProp in stubFilters) {\n          const filterValues = stubFilters[filterProp];\n          if (filterValues[option.text]) {\n            return false;\n          }\n        }\n        return true;\n      });\n\n      dCopy[key] = options;\n      return dCopy;\n    });\n\n    const stubKeys = pivotData.props.stubs;\n    const headerKeys = pivotData.props.headers;\n\n    const {headersRows} = this.state;\n    const headerLastRowIndex = headersRows.length - 1;\n    const headersSpanSize =\n      headersRows.length > 0 ? headersRows[headerLastRowIndex].length : 1;\n\n    let currKey = '';\n\n    return (\n      <table className=\"pvtTable\">\n        <thead>\n          {multiFlatMode && (\n            <React.Fragment>\n              <tr>\n                <td colSpan=\"2\"></td>\n                {headerKeys.map((headerKey, i) => {\n                  const headerEntries = headerData.find(record =>\n                    record[headerKey] ? record : null\n                  )[headerKey];\n\n                  return (\n                    <th\n                      className=\"pvtColLabel\"\n                      key={`headerKeyTitle${i}`}\n                      colSpan={headerEntries.length}\n                    >\n                      {headerKey}\n                    </th>\n                  );\n                })}\n              </tr>\n              <tr>\n                <td colSpan=\"2\"></td>\n                {headerKeys.map(headerAttr => {\n                  const headerEntries = headerData.find(record =>\n                    record[headerAttr] ? record : null\n                  )[headerAttr];\n\n                  return headerEntries.map((headerEntry, i) => {\n                    return (\n                      <th className=\"pvtColLabel\" key={`headerKey${i}`}>\n                        {headerEntry.text}\n                      </th>\n                    );\n                  });\n                })}\n              </tr>\n            </React.Fragment>\n          )}\n\n          {multiFlatMode && (\n            <tr>\n              <th colSpan=\"2\">Base</th>\n              {headerKeys.map(headerAttr => {\n                const headerFullEntry = headerData.find(record =>\n                  record[headerAttr] ? record : null\n                );\n                const headerOptions = headerFullEntry[headerAttr];\n\n                return headerOptions.map((headerOption, i) => {\n                  return (\n                    <th className=\"pvtColLabel\" key={`headerKey${i}`}>\n                      {this.getHeaderBase(headerOption, headerFullEntry.id)}\n                    </th>\n                  );\n                });\n              })}\n            </tr>\n          )}\n        </thead>\n\n        <tbody>\n          {multiLevelMode && (\n            <React.Fragment>\n              {headersRows.map(row => (\n                <tr>\n                  <th colSpan=\"2\">{row.title}</th>\n                  {row.html}\n                </tr>\n              ))}\n\n              <tr>\n                <th className=\"pvtRowLabel\" colSpan=\"2\">\n                  Base\n                </th>\n                {headersRows.length > 0 &&\n                  [...Array(headersRows[headerLastRowIndex].length)].map(\n                    (element, index) => {\n                      return (\n                        <th\n                          className=\"pvtColLabel\"\n                          key={`headerKey${index}`}\n                          colSpan=\"1\"\n                        >\n                          {this.getMultiLevelHeaderBase(index, headersSpanSize)}\n                        </th>\n                      );\n                    }\n                  )}\n              </tr>\n            </React.Fragment>\n          )}\n\n          {stubKeys.map((stubKey, i) => {\n            const stubEntry = stubData.find(record =>\n              record[stubKey] ? record : null\n            );\n\n            const sums = {};\n\n            return stubEntry[stubKey].map((stubOption, j) => {\n              let showStubLabel = true;\n\n              if (headerKeys.length > 0)\n                if (j === 0) {\n                  headerKeys.map(headerAttr => {\n                    const headerOptions = headerData.find(record =>\n                      record[headerAttr] ? record : null\n                    );\n\n                    if (headerOptions[headerAttr]) {\n                      headerOptions[headerAttr].forEach(headerOption => {\n                        if (headerOption.stubScores) {\n                          const objs = Object.values(\n                            headerOption.stubScores[headerAttr]\n                          );\n\n                          if (objs.length > 0) {\n                            headerOption.stubScores[headerAttr] = {};\n                          }\n                        }\n                      });\n                    }\n                  });\n                }\n\n              if (currKey !== stubKey) {\n                currKey = stubKey;\n              } else {\n                showStubLabel = false;\n              }\n\n              const qLabelRowSpan = stubEntry[stubKey].length;\n\n              return (\n                <React.Fragment>\n                  <tr key={`stubKeyRow${i}`}>\n                    {showStubLabel && (\n                      <th\n                        key={`stubKeyLabel2${i}-${j}`}\n                        rowSpan={qLabelRowSpan}\n                      >\n                        {stubKey}\n                      </th>\n                    )}\n                    <th key={`stubKeyLabel${i}-${j}`} className=\"pvtRowLabel\">\n                      {stubOption.text}\n                    </th>\n\n                    {multiFlatMode &&\n                      headerKeys.map(headerAttr => {\n                        const headerEntry = headerData.find(record =>\n                          record[headerAttr] ? record : null\n                        );\n\n                        return this.calculateCell(\n                          stubOption,\n                          stubEntry.id,\n                          headerEntry,\n                          headerAttr\n                        );\n                      })}\n\n                    {multiLevelMode &&\n                      headersRows.length > 0 &&\n                      [...Array(headersRows[headerLastRowIndex].length)].map(\n                        (_, index) => {\n                          return this.calculateMultiLevelCell(\n                            stubOption,\n                            stubEntry.id,\n                            index,\n                            headersSpanSize,\n                            sums\n                          );\n                        }\n                      )}\n                  </tr>\n\n                  {multiFlatMode &&\n                    [true].map(_ => {\n                      const missingValues = this.calculateMissingValues(\n                        headerData,\n                        headerKeys,\n                        stubEntry.id\n                      );\n                      if (\n                        j === stubEntry[stubKey].length - 1 &&\n                        missingValues.filter(value => value > 0).length > 0\n                      ) {\n                        return (\n                          <tr>\n                            <td></td>\n                            <th key={`stubKeyLabel2${i}-${j}-${j}`}>\n                              Missing Values\n                            </th>\n                            {missingValues.map(missingValue => {\n                              return (\n                                <td>\n                                  {missingValue}\n                                  {this.props.settings.showPercentage && '%'}\n                                </td>\n                              );\n                            })}\n                          </tr>\n                        );\n                      }\n\n                      return null;\n                    })}\n\n                  {multiLevelMode &&\n                    [true].map(_ => {\n                      if (j === stubEntry[stubKey].length - 1) {\n                        const missingValues = this.calculateMultiLevelMissingValue(\n                          headersSpanSize,\n                          sums\n                        );\n\n                        if (\n                          missingValues.filter(value => value > 0).length > 0\n                        ) {\n                          return (\n                            <tr>\n                              <td></td>\n                              <th key={`stubKeyLabel2${i}-${j}-${j}`}>\n                                Missing Values\n                              </th>\n                              {missingValues.map(missingValue => {\n                                return (\n                                  <td>\n                                    {missingValue}\n                                    {this.props.settings.showPercentage && '%'}\n                                  </td>\n                                );\n                              })}\n                            </tr>\n                          );\n                        }\n                      }\n\n                      return null;\n                    })}\n                </React.Fragment>\n              );\n            });\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nexport default TableRenderer;\n"]}